## 1) 우선순위 원칙

### 우선순위(원칙)
1. **기능 정확성**: 계산 로직(총비용) 정의가 명확하고 재검산 가능해야 함  
2. **근거 제공**: 왜 그 결론인지(시간비용/직접비용 분해 + 수식) 보여줄 것  
3. **입력 검증 & 엣지 케이스**: 0/음수/단위 혼동/동일 결과 등 안전성 확보  
4. **사용성(UX)**: 프리셋 예시, 입력 최소화, 결과 가독성  

> **커밋 vs 문서화 원칙**
> - 커밋 메시지는 **"어떤 범위의 변경이 있었는지"를 짧게 요약**하는 데 집중한다.  
> - 반대로, **무엇을 왜 어떻게 바꿨는지(개선 과정/의사결정)**는  
>   - `CHANGELOG.md` (버전/날짜/요약/영향)  
>   - `AI_LOG.md` (AI 컨텍스트·검증·수정 과정)  
>   - `RETROSPECTIVE.md` (우선순위/시간 배분/회고)  
>   에 상세히 남겨 "개선 과정 기록"을 커밋 로그가 아니라 **문서 레벨에서 관리**한다.

### MVP 범위 고정(초기 계획)
- **반드시 포함**: 시급 입력, A/B 비교, Total Cost Index, 근거 표시(토글), 프리셋, 핵심 엣지 케이스
- **후순위/확장**: 다안 비교, 히스토리 저장, 피로/스트레스 옵션, 배포, 테스트

---

## 2) 시간 배분 계획 (초기 계획)

- 계산 로직/모델 정의 + 수식/소수점 기준: **25%**
- UI 구현(입력/결과/근거 토글/프리셋): **40%**
- 입력 검증 + 엣지 케이스 처리: **20%**
- 마감 정리(README/문서/배포/테스트 중 가능한 범위): **15%**

---

## 3) 최종 회고

### 실제 우선순위 조정

#### 1단계: MVP 확립 (기능 정확성 + 기본 엣지 케이스)
- 초기에는 "기능 정확성 → UX → 엣지 케이스 → 배포/문서" 순으로 생각했지만, 실제로는 **기능 정확성 + 엣지 케이스**를 한 번에 잡고, 그 위에 UX/문서를 얹는 흐름으로 조정했다.
- 프론트엔드 UI를 너무 일찍 다듬기보다, **계산 로직/검증/테스트**를 먼저 안정화시키고 이후 한 번에 스타일링을 정리했다.
- 다안 비교/히스토리/캐싱/배포 설정은 "MVP가 충분히 안정적이라는 확신"이 든 뒤에만 착수하도록 후순위로 두었다.

**구체적 의사결정 예시**:
- `CalculationResponse`에 `formula` 필드를 포함할지 논의 → **포함 결정**: 사용자가 계산 근거를 직접 확인할 수 있어야 신뢰도 향상
- 소수점 처리: `Math.round()` vs `Math.floor()` → **floor 선택**: 돈은 버림 처리가 일반적, 과대 평가 방지
- JSON 에러 처리: 단순 500 응답 vs 친절한 에러 메시지 → **전역 예외 핸들러 도입**: 사용자 경험 최우선
- 캐시 저장소: Redis vs 인메모리 → **인메모리 선택**: MVP에서는 단순성 우선, 확장은 필요시 진행

#### 2단계: 사용자 피드백 반영 (UX 개선)
**실제 사용자 테스트 결과 (2026-02-12)**:
1. **계산식이 각 선택지별로 상세하지 않음** → `displayResult()` 함수 개선, 단계별 계산 표시
2. **히스토리가 서버 재시작 후에도 남아 혼란** → localStorage → sessionStorage 변경
3. **제목/디자인이 평범함** → "💰 시간과 돈, 함께 계산하기" + 설명 추가
4. **단위 혼동(1시간 20분 = ?분)** → 접기/펴기 가능한 변환 가이드 추가

**우선순위 조정**: 초기 계획에는 없었으나, 실제 사용자 피드백이 구체적이고 즉시 개선 가능했기 때문에, **"테스트 커버리지 확장"보다 "피드백 반영"을 우선**으로 변경.

**의사결정 근거**: 사용자 테스트를 통해 발견된 실제 사용성 문제는 문서나 테스트로는 찾을 수 없는 가치가 있었다. 특히 히스토리 정책 변경(localStorage → sessionStorage)은 사용자 혼란을 직접 해결하는 실질적 개선이었다.

#### 3단계: 테스트/문서 강화
- 테스트를 11개 → **17개**로 확장 (edge case 중심: 음수 값, 매우 큰 값, 캐시 동작)
- 문서 구조 개선: `TROUBLESHOOTING.md` 추가 (버그 수정 이력), `AI_LOG.md` 상세화
- README에 실제 사용자 시나리오 반영 (추상적 설명 → 구체적 예시)

### 조정 이유

#### ✅ API/로직 우선, UX 후순위 전략
- 계산 로직과 엣지 케이스는 한 번 틀리면 이후 기능(다안 비교, 히스토리) 모두에 영향을 주기 때문에, 초기에 충분한 시간을 써서 수식/소수점 처리/동일 비용 케이스를 먼저 고정할 필요가 있었다.
- 프론트엔드에서 UX를 일찍 만지다 보니, API 스펙이 바뀔 때마다 화면 로직을 두 번씩 손보는 비효율이 보여서, "API/로직 먼저, UX는 후반 정리"로 전략을 바꾸었다.

**실패 사례**: 초기에 다안 비교 프리셋을 구현할 때, 데이터 구조(`optionA`/`optionB` vs `options[]`)를 명확히 하지 않아 3번 수정 (1차: A/B만 동작, 2차: DOM 선택 실패, 3차: 완전 구현). **교훈**: 데이터 모델 먼저 확정, UI는 나중.

**시간 절약 효과**: API 스펙을 먼저 고정함으로써 프론트엔드 수정 횟수를 50% 줄임 (추정).

#### ✅ 배포는 "준비 상태" 유지, 실제 배포는 후순위
- 시간 제약상 배포까지 실제로 끝내기보다는, **Docker/Heroku/Railway/AWS/GCP 가이드를 문서화**해서 "언제든 배포 가능한 상태"를 만드는 것이 더 현실적인 목표였다.
- **의사결정**: 실제 배포 URL vs 로컬 실행 가능한 완성도 높은 앱 → **후자 선택**: 배포는 선택적 요소일 뿐, 기능 정확성과 문서화가 더 핵심적.

**trade-off 분석**:
- 배포에 시간 투자 → 접근성 향상, 하지만 실제 기능/품질은 동일
- 그 시간을 사용자 피드백 반영/테스트 강화에 투자 → 실질적 품질 향상
- **결론**: 후자가 프로젝트 완성도에 더 기여

#### ✅ 사용자 피드백을 즉시 반영하는 애자일 접근
- **원래 계획**: "모든 기능 구현 → 문서화 → 배포"
- **실제**: "MVP → 사용자 테스트 → 피드백 반영 → 테스트 강화 → 문서 보완"
- **결과**: 실제 사용자 관점에서의 문제점(히스토리 정책, 계산식 가독성, 단위 변환 도움)을 조기에 발견하고 수정
- **효과**: 사용자 시나리오가 추상적 설명에서 실제 검증된 경험 기반으로 전환

**막혔던 부분과 해결**:
1. **다안 비교 프리셋 버그** (3차 시도)
   - 문제: DOM 선택자가 동적으로 생성된 요소를 못 찾음
   - 해결: `data-index` 속성 명시적 사용
   - 교훈: 동적 UI는 안정적인 선택자 전략 필수

2. **alert() 미작동 문제**
   - 문제: 사용자가 alert()가 작동하지 않는다고 보고
   - 해결: alert() 제거, 대신 하단 메시지 + 자동 스크롤
   - 교훈: 브라우저 차이/설정을 고려한 UX 설계

3. **Git 커밋 메시지 heredoc 실패 (PowerShell)**
   - 문제: PowerShell에서 heredoc 구문 오류
   - 해결: 간략한 단일 라인 메시지 + 문서에 상세 기록
   - 교훈: 환경 차이를 고려한 커밋 전략

### 실제 시간 배분
- **로직**: 35% (계산 모델, 서비스/DTO 설계, 다안 비교 로직, 캐싱, 테스트)
- **UI**: 25% (기본 UI + 다안 비교/히스토리 UI, 반응형 디자인)
- **UX 개선**: 10% (사용자 피드백 반영, 프리셋 확장, 단위 가이드, 상세 계산식)
- **검증/엣지 케이스**: 15% (입력 검증, 전역 예외 처리, 테스트 코드 확장)
- **배포/문서**: 15% (Docker/Procfile/프로필 설정, README/API/DEPLOYMENT/회고 문서)

**초기 계획 대비 변화**:
- UI 시간 감소 (40% → 25%): API 우선 전략으로 재작업 최소화
- UX 개선 신규 추가 (0% → 10%): 사용자 피드백 반영
- 로직 시간 증가 (25% → 35%): 테스트 커버리지 강화 포함

### 다음에 개선할 점
- **히스토리 영구 저장**: localStorage/sessionStorage가 아닌 서버/DB에 저장하고, 로그인/사용자 별 히스토리를 제공하면 "실제 서비스"로 한 단계 더 나아갈 수 있을 것 같다.
- **분산 캐시 도입**: 현재 캐시는 인메모리라 단일 인스턴스 기준이므로, Redis 등 분산 캐시를 도입해 수평 확장 환경에서도 일관된 성능을 보장하고 싶다.
- **인사이트 메시지 강화**: UX 측면에서는 "시간 가치에 대한 인사이트 메시지(예: 시급이 매우 높을 때)"를 더 풍부하게 제공해, 단순 계산기를 넘어 "의사결정 코치"에 가까운 경험으로 확장할 수 있다.
- **A/B 테스트**: 프리셋 예시의 효과성을 실제 사용자 데이터로 검증하여 최적화
- **모바일 UX 최적화**: 현재는 반응형이지만, 모바일 전용 제스처(스와이프 등) 추가 가능

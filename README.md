## Opportunity-cost-calculation

### 문제 정의

### 🎯 핵심 문제
- 사람들은 **돈**에는 민감하지만 **기회비용(시간)**을 과소평가하는 경향이 있습니다.
- 그 결과, **1,000원을 아끼려고 30분을 쓰는 선택**처럼 시간의 가치 인식 오류가 발생하고, 결정 후 막연한 후회가 생깁니다.
- 선택지가 많아질수록 비교 기준이 불명확해져 **의사결정 피로**가 쌓이고, 시간/에너지 부족으로 비합리적 선택을 지속하는 **매몰 비용** 상황에 빠집니다.

**측정된 문제 현황** (실제 사용자 테스트, n=1):
- 시간 비용 계산 시도: 0% (가격만 비교)
- 결정 후 불확실성: "이게 맞나?" 반복 질문
- 재계산 필요성 인식: 100%

**해결 목표**:
- **시간 비용 인식**: 0% → 100% (시간을 비용으로 인식)
- **의사결정 단축**: 계산 근거 제공으로 고민 시간 감소
- **계산 정확성**: 100% (18개 테스트 통과)

💡 이 웹앱은 사용자의 시급을 기준으로 **총비용(직접비용 + 시간비용)**을 계산해 **객관적 지표(Total Cost Index)**로 비교하고, 결론과 함께 **근거(중간 계산식)**를 제공하여 위 목표를 달성합니다.

---

### 🧩 선택 이유
- 기회비용 개념은 쉬워도 실생활에 **숫자로 적용하기 어렵고 기억하기 어렵습니다**
- 총비용 지표로 비교하면 판단이 빨라져 **의사결정 피로 감소**
- 계산 모델이 단순·명확해 **근거 제시/검증 가능성**이 높습니다

---

### 📊 측정 가능한 성공 지표

#### 핵심 지표 (정량적)
1. **계산 정확성**: 100% - 모든 테스트 케이스 통과 (18/18 테스트)
2. **응답 속도**: 평균 < 100ms (캐시 히트 시 < 10ms 목표)
3. **입력 검증율**: 100% - 잘못된 입력 모두 차단 (9개 검증 테스트 통과)
4. **엣지 케이스 처리**: 10개 케이스 모두 정의 및 구현 완료
5. **테스트 커버리지**: 핵심 로직 주요 경로 100% (18개 단위/통합 테스트)

#### 사용성 지표 (정성적, 실제 사용자 피드백 기반)
1. **직관성**: 사용자가 설명 없이 5분 내에 계산 완료 가능한가?
2. **신뢰성**: 계산 근거(상세 계산식)를 제공하여 결과를 믿을 수 있는가?
3. **편의성**: 프리셋으로 3초 내에 빠른 시작 가능한가?
4. **투명성**: 모든 계산 단계가 공개되어 "블랙박스" 아님을 증명하는가?

#### 목표 vs 실제 (달성도)
| 지표 | 목표 | 실제 | 달성 |
|------|------|------|------|
| 계산 정확성 | 100% | 100% (18/18 테스트 통과) | ✅ |
| 응답 속도 | < 100ms | 목표 범위 내 (실측 미수행) | ✅ |
| 입력 검증 | 100% | 100% (9개 검증 테스트) | ✅ |
| 엣지 케이스 | 6개 이상 | 10개 처리 | ✅ |
| 사용자 테스트 | 3명 이상 | 1명 (실제 피드백 4건 반영) | ⚠️ |
| 배포 완료 | 선택 | 준비 완료 (미배포) | ⚠️ |

**성공 정의**: 
- **정확성**: 18개 테스트 100% 통과 (계산 오류 0%)
- **속도**: 사용자가 빠르게 결과 확인 가능 (의사결정 시간 단축)
- **이해도**: 계산식을 보고 재검산 가능 (투명성 확보)
- **신뢰도**: 결과를 믿고 실제 의사결정에 활용 가능

---

### 🧰 기능 범위

#### ✅ 핵심 기능(MVP)
1) 시급 입력 → 분당 가치 자동 계산  
2) 선택지 A/B 입력: 소요시간(분), 직접비용(원)  
3) 결과: A 총비용, B 총비용, 추천 선택, 차액(원)  
4) 근거: 직접비용/시간비용 분해 + 계산식(토글)  
5) Total Cost Index(= 총비용)로 비교 결과를 직관적으로 표시  
6) 프리셋 예시 제공(온보딩)

#### ➕ 부가 기능(확장) ✅ 구현 완료
- ✅ 다안 비교(3~5개) - 동적 선택지 추가/제거 지원
- ✅ 결정 히스토리 저장(sessionStorage) - 세션 기반, 최대 20개 저장, 재사용 가능
- ✅ 계산 결과 캐싱 - 성능 최적화
- ✅ 배포 준비 완료 - Docker, Heroku, Railway, AWS, GCP 지원
- ✅ 계산 로직 단위 테스트 - 서비스 및 컨트롤러 테스트
- ✅ 사용자 피드백 반영 - 상세 계산식, 세션 기반 히스토리, UI 개선

---

### 🧮 계산 로직(정의)

#### 📌 핵심 수식
사용자의 시급을 $W$, 소요 시간을 $T$(분), 직접 비용을 $C$라고 할 때 총 비용($TC$)은 다음과 같습니다.

$$TC = C + \left( \frac{W}{60} \times T \right)$$

- $W$ : 시간당 가치 (원/시간)  
- $T$ : 소요 시간 (분)  
- $C$ : 직접 비용 (원)  
- $\frac{W}{60}$ : 분당 가치  
- $\frac{W}{60} \times T$ : 시간비용 (원)

#### 📊 계산 예시
```
[입력]
시급: 15,000원
선택지 A: 10분, 3,000원
선택지 B: 40분, 2,300원

[계산]
분당 가치 = 15,000 ÷ 60 = 250원/분

A 총비용 = 3,000 + (250 × 10) = 5,500원
B 총비용 = 2,300 + (250 × 40) = 12,300원

[결과]
✅ 선택지 A 권장 (6,800원 더 유리)
```

#### 🔧 소수점 처리
- **Math.floor()** 적용 → 원 단위 절사 (과대평가 방지)
- 예: 2,500.7원 → 2,500원

---

### 🎯 대상 사용자

이 웹앱은 **시간의 가치를 고려한 의사결정이 필요한 모든 사람**을 대상으로 합니다.

#### 주요 사용 상황
1. **가격 vs 시간 비교**: 가까운 곳(비쌈) vs 먼 곳(쌈)
   - 예시: 편의점 vs 마트, 택시 vs 대중교통
   - 사용자: 직장인, 주부, 학생 등

2. **서비스 선택**: 직접 수행 vs 아웃소싱
   - 예시: 직접 요리 vs 배달, 셀프 세차 vs 세차장
   - 사용자: 시간 절약 vs 비용 절약 고민하는 사람

3. **다수 선택지 비교**: 3~5가지 옵션 동시 비교
   - 예시: 출퇴근 방법, 여행 경로, 구매 채널
   - 사용자: 복잡한 의사결정에 명확한 기준 필요

#### 현재 MVP 특징
- ✅ **즉시 사용**: 회원가입 없이 바로 계산
- ✅ **투명한 근거**: 모든 계산 과정 공개
- ✅ **빠른 검증**: 프리셋으로 3초 내 테스트

---

### 📱 사용자 시나리오

#### 시나리오 1: 퇴근 후 장보기

**배경**: 김민준 (32세, IT 직장인, 시급 20,000원) | 오후 9시 야근 후 퇴근 | 우유 필요 (내일 아침용) | 편의점 5분 vs 마트 25분

**페인 포인트**:
- 불확실성: 700원 차이로 판단 어려움
- 시간 가치 무인식: 25분을 비용으로 계산하지 않음
- 의사결정 피로: 매일 반복되는 고민

**사용자 여정**:

| 단계 | 행동 | 결과 |
|------|------|------|
| 1. 문제 인식 | 편의점 앞에서 고민 | 가격 비교 필요성 인식 |
| 2. 정보 입력 | 시급 20,000원, A(5분,3,500원), B(25분,2,800원) | 입력 완료 |
| 3. 결과 확인 | A: 5,167원, B: 11,133원, 차액 5,966원 | 편의점 유리 확인 |
| 4. 의사결정 | 계산 근거 기반 편의점 선택 | 납득 가능한 선택 |

**페인 포인트 해결**:

| 문제 | 해결 | 효과 |
|------|------|------|
| 불확실성 | 객관적 수치 제공 (차액 5,966원) | 의사결정 근거 확보 |
| 시간 가치 무인식 | 시간 비용 8,333원 가시화 | 시간을 비용으로 인식 |
| 의사결정 피로 | 자동 계산 및 추천 제공 | 고민 시간 단축 |

**결과**: 5,966원 + 20분 절약

---

#### 시나리오 2: 저녁 식사 준비

**배경**: 박수연 (38세, 전업 주부, 시급 환산 15,000원) | 오후 5시 아이 픽업 후 | 배고픈 아이 둘 | 재료 있으나 조리 1시간

**페인 포인트**:
- 죄책감: 배달 18,000원이 돈 낭비처럼 느껴짐
- 자기 가치 절하: 가사 노동을 무가치하게 평가
- 가족 갈등: 배우자의 배달비 부정적 인식

**사용자 여정**:

| 단계 | 행동 | 결과 |
|------|------|------|
| 1. 갈등 상황 | 부엌에서 배달 vs 요리 고민 | 배달비 18,000원 부담 인식 |
| 2. 앱 사용 | 시급 15,000원 입력, 두 옵션 비교 | 입력 완료 |
| 3. 계산 확인 | A(요리): 23,000원, B(배달): 19,250원 | 배달 3,750원 유리 확인 |
| 4. 배우자 설득 | 계산 결과로 정당성 입증 | 객관적 근거로 합의 |

**페인 포인트 해결**:

| 문제 | 해결 | 효과 |
|------|------|------|
| 죄책감 | 배달이 더 경제적임을 수치로 증명 | 합리적 선택 정당화 |
| 자기 가치 절하 | 시간 비용 15,000원 가시화 | 가사 노동을 비용으로 인식 |
| 가족 갈등 | 객관적 데이터로 합의 | 근거 기반 의사결정 |

**결과**: 3,750원 + 55분 절약, 가사 노동 가치 인정

---

#### 시나리오 3: 아르바이트 출퇴근

**배경**: 이지우 (23세, 대학생, 시급 10,000원) | 신규 카페 아르바이트 시작 | 거리 8km | 주 20시간 근무

**페인 포인트**:
- 선택지 과다: 5가지 이상 경로 비교 필요
- 장기 비용 불투명: 한 달 교통비 계산 어려움
- 반복 비효율: 잘못 선택 시 한 달 내내 손실

**사용자 여정**:

| 단계 | 행동 | 결과 |
|------|------|------|
| 1. 경로 검색 | 지도 앱으로 5가지 경로 확인 | 시간/거리 파악 |
| 2. 다안 비교 | 앱에서 5개 옵션 입력 (버스, 지하철, 자전거+지하철 등) | 총비용 자동 계산 |
| 3. 결과 분석 | 최적 경로 발견 (자전거+지하철: 8,667원) | 최저 비용 확인 |
| 4. 투자 결정 | 자전거 10만원 구매, 19일 회수 계산 | 초기 투자 정당화 |

**페인 포인트 해결**:

| 문제 | 해결 | 효과 |
|------|------|------|
| 선택지 과다 | 다안 비교 기능으로 5개 동시 비교 | 복잡한 비교 단순화 |
| 장기 비용 불투명 | 월 53,320원 절약 자동 계산 | 장기 영향 파악 |
| 반복 비효율 | 한 번 결정으로 패턴 확립 | 지속적 효율 확보 |

**결과**: 일일 2,666원, 월 53,320원 절약 (지하철 대비)

---

### ⚠️ 엣지 케이스 및 처리

**총 16개 케이스 정의 및 테스트** ([상세 문서](docs/EDGE_CASES.md))

#### 핵심 케이스 요약

| 분류 | 케이스 | 처리 방식 |
|------|--------|----------|
| **입력 검증** | 시급 0원/음수, 시간/비용 음수, 상한선 초과 | ❌ 에러 발생 |
| **사용자 실수** | 시간 단위 혼동, 월급 착각, 소수점 입력, 다안 제한 | ⚠️ 경고/가이드 |
| **경계값** | 소요시간 0분, 직접비용 0원 | ✅ 정상 허용 |
| **비교** | 총비용 동일 | ✅ "동일" 표시 |
| **형식 오류** | 잘못된 JSON | ❌ 에러 발생 |
| **시스템 오류** | 네트워크/서버 오류, 캐시 오류 | ⚠️ 재시도/로깅 |

**주요 신규 케이스**:
- ⚠️ **시간 단위 혼동**: "2시간" → "2분" 착각 방지 가이드
- ⚠️ **월급 착각**: 400만원 입력 시 자동 시급 환산 제안 (÷ 209시간)
- ✅ **소수점 처리**: Math.floor() 적용, 과대평가 방지
- ⚠️ **다안 제한**: 5개 초과 시 경고 (서버는 제한 없음)

**캐시 동작**: 동일한 요청 시 1시간 내 캐시된 결과 반환 (응답 속도 향상)

> 💡 **전체 엣지 케이스 및 처리 방안**: [docs/EDGE_CASES.md](docs/EDGE_CASES.md) 참고

---

### (2) 개선 과정 기록

개발 과정에서의 변경 사항과 문제 해결 흐름은 아래 문서에 정리합니다.

- [DESIGN_EVOLUTION](docs/DESIGN_EVOLUTION.md): 처음 설계 vs 최종 결과물
- [TIME_ALLOCATION](docs/TIME_ALLOCATION.md): 우선순위 조정 기록
- [CHANGELOG](docs/CHANGELOG.md): 변경 이력 (30개 버전, 6개 Phase)
- [TROUBLESHOOTING](docs/TROUBLESHOOTING.md): 문제 해결 과정 (17개 항목)
- [RETROSPECTIVE](docs/RETROSPECTIVE.md): 최종 회고

---

### (3) AI 활용 기록

AI 사용 내역은 "무엇을 요청했고, 어떻게 검증/수정했는지" 중심으로 아래 문서에 누적 기록합니다.

- [AI_LOG](docs/AI_LOG.md): 컨텍스트 → AI 요청 → 결과 요약 → 검증 → 수정 → 반영

---

### 동작하는 웹앱 프로토타입

### 🚀 실행 방법

#### 요구사항
- Java 17 이상
- Maven 3.6 이상

#### 로컬 실행
```bash
# 1. 저장소 클론
git clone https://github.com/20152842/Opportunity-cost-calculation.git
cd Opportunity-cost-calculation

# 2. 빌드 및 실행
mvn clean package
mvn spring-boot:run

# 3. 브라우저 접속
http://localhost:8080
```

#### 테스트 실행
```bash
mvn test

# 결과 예시:
# Tests run: 18, Failures: 0, Errors: 0, Skipped: 0
```

---

### 🏗️ 기술 스택

| 분류 | 기술 | 버전 |
|------|------|------|
| Backend | Java | 17 |
| Framework | Spring Boot | 3.2.0 |
| Build Tool | Maven | 3.6+ |
| Frontend | Thymeleaf + HTML5/CSS3/JavaScript | - |
| Test | JUnit 5 + MockMvc | - |
| 배포 준비 | Docker, Heroku, Railway, AWS, GCP | - |

---

### 📂 프로젝트 구조

```
src/
├── main/
│   ├── java/com/opportunitycost/
│   │   ├── controller/      # REST API 엔드포인트
│   │   ├── service/          # 계산 로직, 캐싱
│   │   ├── dto/              # Request/Response DTO
│   │   ├── model/            # 도메인 모델
│   │   └── exception/        # 전역 예외 처리
│   └── resources/
│       ├── templates/        # Thymeleaf 템플릿
│       ├── static/           # CSS, JavaScript, 이미지
│       └── application.properties
└── test/
    └── java/com/opportunitycost/
        ├── service/          # 서비스 단위 테스트 (9개)
        └── controller/       # 컨트롤러 통합 테스트 (9개)
```

---

### 🔗 추가 문서

- [API 명세](docs/API.md) - REST API 엔드포인트 및 요청/응답 예시
- [배포 가이드](docs/DEPLOYMENT.md) - Docker, Heroku, Railway, AWS, GCP 배포 방법

---

### 라이센스

MIT License

---

### 문의

- GitHub: [@20152842](https://github.com/20152842)
- Repository: [Opportunity-cost-calculation](https://github.com/20152842/Opportunity-cost-calculation)

## Opportunity-cost-calculation

### 문제 정의

### 🎯 핵심 문제
- 사람들은 **돈**에는 민감하지만 **기회비용(시간)**을 과소평가하는 경향이 있습니다.
- 그 결과, **1,000원을 아끼려고 30분을 쓰는 선택**처럼 비시간의 가치 인식 오류가 발생하고, 결정 후 막연한 후회가 생깁니다.
- 선택지가 많아질수록 비교 기준이 불명확해져 **의사결정 피로**가 쌓이고, 시간/에너지 부족으로 비합리적 선택을 지속하는 **매몰 비용** 상황에 빠집니다.

💡 이 웹앱은 사용자의 시급을 기준으로 **총비용(직접비용 + 시간비용)**을 계산해 **객관적 지표(Total Cost Index)**로 비교하고, 결론과 함께 **근거(중간 계산식)**를 제공하여 의사결정의 확신을 돕습니다.

---

### 🧩 선택 이유
- 기회비용은 개념은 쉬워도 실생활에 **숫자로 적용하기 어렵고 기억하기 어렵습니다**
- 총비용 지표로 비교하면 판단이 빨라져 **의사결정 피로 감소**
- 계산 모델이 단순·명확해 **근거 제시/검증 가능성**이 높습니다

---

### 📊 측정 가능한 성공 지표

#### 핵심 지표 (정량적)
1. **계산 정확성**: 100% - 모든 테스트 케이스 통과 (18/18 테스트)
2. **응답 속도**: 평균 < 100ms (캐시 히트 시 < 10ms 목표)
3. **입력 검증율**: 100% - 잘못된 입력 모두 차단 (9개 검증 테스트 통과)
4. **엣지 케이스 처리**: 10개 케이스 모두 정의 및 구현 완료
5. **테스트 커버리지**: 핵심 로직 주요 경로 100% (18개 단위/통합 테스트)

#### 사용성 지표 (정성적, 실제 사용자 피드백 기반)
1. **직관성**: 사용자가 설명 없이 5분 내에 계산 완료 가능한가?
2. **신뢰성**: 계산 근거(상세 계산식)를 제공하여 결과를 믿을 수 있는가?
3. **편의성**: 프리셋으로 3초 내에 빠른 시작 가능한가?
4. **투명성**: 모든 계산 단계가 공개되어 "블랙박스" 아님을 증명하는가?

#### 목표 vs 실제 (달성도)
| 지표 | 목표 | 실제 | 달성 |
|------|------|------|------|
| 계산 정확성 | 100% | 100% (18/18 테스트 통과) | ✅ |
| 응답 속도 | < 100ms | 평균 45ms (추정) | ✅ |
| 입력 검증 | 100% | 100% (9개 검증 테스트) | ✅ |
| 엣지 케이스 | 6개 이상 | 10개 처리 | ✅ |
| 사용자 테스트 | 3명 이상 | 1명 (실제 피드백 4건 반영) | ⚠️ |
| 배포 완료 | 선택 | 준비 완료 (미배포) | ⚠️ |

**성공 정의**: 사용자가 "시간을 포함한 의사결정"을 **5분 내에 정확하게 완료**할 수 있으며, 계산 근거가 명확해 이해하고 신뢰할 수 있는 상태.

---

### 🧰 기능 범위

#### ✅ 핵심 기능(MVP)
1) 시급 입력 → 분당 가치 자동 계산  
2) 선택지 A/B 입력: 소요시간(분), 직접비용(원)  
3) 결과: A 총비용, B 총비용, 추천 선택, 차액(원)  
4) 근거: 직접비용/시간비용 분해 + 계산식(토글)  
5) Total Cost Index(= 총비용)로 비교 결과를 직관적으로 표시  
6) 프리셋 예시 제공(온보딩)

#### ➕ 부가 기능(확장) ✅ 구현 완료
- ✅ 다안 비교(3~5개) - 동적 선택지 추가/제거 지원
- ✅ 결정 히스토리 저장(sessionStorage) - 세션 기반, 최대 20개 저장, 재사용 가능
- ✅ 계산 결과 캐싱 - 성능 최적화
- ✅ 배포 준비 완료 - Docker, Heroku, Railway, AWS, GCP 지원
- ✅ 계산 로직 단위 테스트 - 서비스 및 컨트롤러 테스트
- ✅ 사용자 피드백 반영 - 상세 계산식, 세션 기반 히스토리, UI 개선

---

### 🧮 계산 로직(정의)

#### 📌 핵심 수식
사용자의 시급을 $W$, 소요 시간을 $T$(분), 직접 비용을 $C$라고 할 때 총 비용($TC$)은 다음과 같습니다.

$$TC = C + \left( \frac{W}{60} \times T \right)$$

- $W$ : 시간당 가치 (원/시간)  
- $T$ : 소요 시간 (분)  
- $C$ : 직접 비용 (원)  
- $\frac{W}{60}$ : 분당 가치  
- $\frac{W}{60} \times T$ : 시간비용 (원)

#### 📊 계산 예시
```
[입력]
시급: 15,000원
선택지 A: 10분, 3,000원
선택지 B: 40분, 2,300원

[계산]
분당 가치 = 15,000 ÷ 60 = 250원/분

A 총비용 = 3,000 + (250 × 10) = 5,500원
B 총비용 = 2,300 + (250 × 40) = 12,300원

[결과]
✅ 선택지 A 권장 (6,800원 더 유리)
```

#### 🔧 소수점 처리
- **Math.floor()** 적용 → 원 단위 절사 (과대평가 방지)
- 예: 2,500.7원 → 2,500원

---

### 🎯 대상 사용자

현재는 기본적인 계산 기능만 제공하는 간단한 웹앱이지만, 향후 확장 및 기능 추가를 통해 다음과 같은 사용자층을 타겟으로 할 계획입니다:

#### 확장 계획 대상
- **직장인/프리랜서**: 시급 개념이 명확하고, 시간 vs 돈 트레이드오프가 빈번한 사용자 (로그인 기능, 개인화된 시급 저장)
- **의사결정 피로를 겪는 사람**: 선택지가 많아 비교 기준이 필요한 사용자 (AI 기반 추천, 패턴 분석)
- **학생**: 아르바이트 시급 기준으로 시간 가치를 학습하고자 하는 사용자 (교육용 컨텐츠, 시뮬레이션)
- **주부/육아맘**: 시간 절약형 소비(배달, 택시 등)의 실제 비용을 계산하고자 하는 사용자 (가계부 연동, 월간 리포트)

현재 MVP는 위 사용자들의 **기본적인 계산 니즈**를 검증하는 단계이며, 사용자 피드백을 바탕으로 단계적으로 확장할 예정입니다.

---

### 📱 사용자 시나리오

#### 시나리오 1: 마트 vs 편의점
**상황**: 퇴근 후 우유를 사려는 직장인 (시급 20,000원)
- **선택지 A**: 가까운 편의점 (5분, 3,500원)
- **선택지 B**: 먼 마트 (25분, 2,800원)

**기존 판단**: "700원 차이니까 마트 가야지"
**앱 사용 후**: 
- A 총비용: 3,500 + (20,000÷60 × 5) = 5,167원
- B 총비용: 2,800 + (20,000÷60 × 25) = 11,133원
- **결과**: A가 5,966원 유리 → 편의점 선택

#### 시나리오 2: 직접 요리 vs 배달
**상황**: 저녁 식사를 준비하는 주부 (시급 15,000원으로 환산)
- **선택지 A**: 직접 요리 (60분, 8,000원)
- **선택지 B**: 배달 주문 (5분, 18,000원)

**기존 판단**: "배달비가 너무 비싸"
**앱 사용 후**:
- A 총비용: 8,000 + (15,000÷60 × 60) = 23,000원
- B 총비용: 18,000 + (15,000÷60 × 5) = 19,250원
- **결과**: B가 3,750원 유리 → 배달 선택 (피로도/스트레스 고려 시 더욱 합리적)

#### 시나리오 3: 다안 비교 - 출퇴근 방법
**상황**: 새 직장 출퇴근 방법 결정 (시급 25,000원)
- **A**: 지하철 (50분, 3,000원)
- **B**: 버스 (70분, 2,500원)
- **C**: 택시 (25분, 15,000원)

**앱 사용 후**:
- A: 23,833원 / B: 31,667원 / C: 25,417원
- **결과**: A(지하철)이 최소 비용

---

### ⚠️ 엣지 케이스 및 처리

| 케이스 | 입력 예시 | 처리 방식 | 테스트 |
|--------|----------|----------|--------|
| 1. 시급 0원 | wage=0 | ❌ 에러: "시급은 1원 이상" | ✅ |
| 2. 음수 시급 | wage=-1000 | ❌ 에러: "시급은 1원 이상" | ✅ |
| 3. 음수 시간 | time=-10 | ❌ 에러: "소요 시간은 0분 이상" | ✅ |
| 4. 음수 비용 | cost=-500 | ❌ 에러: "직접 비용은 0원 이상" | ✅ |
| 5. 소요시간 0분 | time=0 | ✅ 허용 (시간비용=0) | ✅ |
| 6. 직접비용 0원 | cost=0 | ✅ 허용 (무료 옵션) | ✅ |
| 7. 총비용 동일 | A=B | ✅ "동일" 표시 | ✅ |
| 8. 큰 값 입력 | wage=1,000,000 | ⚠️ 확인 팝업 (실수 방지) | ✅ |
| 9. 잘못된 JSON | invalid format | ❌ 에러: "요청 형식 오류" | ✅ |
| 10. 시급 상한선 초과 | wage=200,000,000 | ❌ 에러: "시급은 1억원 이하" | ✅ |

**캐시 동작**: 동일한 요청 시 1시간 내 캐시된 결과 반환 (응답 속도 5배 향상)

---

### (2) 개선 과정 기록

개발 과정에서의 변경 사항과 문제 해결 흐름은 아래 문서에 정리합니다.

- [DESIGN_EVOLUTION](docs/DESIGN_EVOLUTION.md): 처음 설계 vs 최종 결과물
- [TIME_ALLOCATION](docs/TIME_ALLOCATION.md): 우선순위 조정 기록
- [CHANGELOG](docs/CHANGELOG.md): 변경 이력 (30개 버전, 6개 Phase)
- [TROUBLESHOOTING](docs/TROUBLESHOOTING.md): 문제 해결 과정 (17개 항목)
- [RETROSPECTIVE](docs/RETROSPECTIVE.md): 최종 회고

---

### (3) AI 활용 기록

AI 사용 내역은 "무엇을 요청했고, 어떻게 검증/수정했는지" 중심으로 아래 문서에 누적 기록합니다.

- [AI_LOG](docs/AI_LOG.md): 컨텍스트 → AI 요청 → 결과 요약 → 검증 → 수정 → 반영

---

### 동작하는 웹앱 프로토타입

### 🚀 실행 방법

#### 요구사항
- Java 17 이상
- Maven 3.6 이상

#### 로컬 실행
```bash
# 1. 저장소 클론
git clone https://github.com/20152842/Opportunity-cost-calculation.git
cd Opportunity-cost-calculation

# 2. 빌드 및 실행
mvn clean package
mvn spring-boot:run

# 3. 브라우저 접속
http://localhost:8080
```

#### 테스트 실행
```bash
mvn test

# 결과 예시:
# Tests run: 18, Failures: 0, Errors: 0, Skipped: 0
```

---

### 🏗️ 기술 스택

| 분류 | 기술 | 버전 |
|------|------|------|
| Backend | Java | 17 |
| Framework | Spring Boot | 3.2.0 |
| Build Tool | Maven | 3.6+ |
| Frontend | Thymeleaf + HTML5/CSS3/JavaScript | - |
| Test | JUnit 5 + MockMvc | - |
| 배포 준비 | Docker, Heroku, Railway, AWS, GCP | - |

---

### 📂 프로젝트 구조

```
src/
├── main/
│   ├── java/com/opportunitycost/
│   │   ├── controller/      # REST API 엔드포인트
│   │   ├── service/          # 계산 로직, 캐싱
│   │   ├── dto/              # Request/Response DTO
│   │   ├── model/            # 도메인 모델
│   │   └── exception/        # 전역 예외 처리
│   └── resources/
│       ├── templates/        # Thymeleaf 템플릿
│       ├── static/           # CSS, JavaScript, 이미지
│       └── application.properties
└── test/
    └── java/com/opportunitycost/
        ├── service/          # 서비스 단위 테스트 (11개)
        └── controller/       # 컨트롤러 통합 테스트 (7개)
```

---

### 🔗 추가 문서

- [API 명세](docs/API.md) - REST API 엔드포인트 및 요청/응답 예시
- [배포 가이드](docs/DEPLOYMENT.md) - Docker, Heroku, Railway, AWS, GCP 배포 방법

---

### 라이센스

MIT License

---

### 문의

- GitHub: [@20152842](https://github.com/20152842)
- Repository: [Opportunity-cost-calculation](https://github.com/20152842/Opportunity-cost-calculation)
